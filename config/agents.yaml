# Multi-Agent Configuration
# Each agent is an independent content generator with its own sources and settings

version: "1.0"

globalSettings:
  contentPath: "./website/src/content"
  defaultRateLimit:
    requestsPerMinute: 30
    maxConcurrent: 3
  
  # AI Model Configuration (Tiered Free-to-Paid)
  aiModels:
    tier1:
      provider: "google"
      model: "gemini-2.0-flash"
      temperature: 0.7
      maxTokens: 8000
      costPerRequest: 0  # Paid tier - unlimited RPD
    
    tier2:
      provider: "groq"
      model: "llama-3.3-70b-versatile"
      temperature: 0.7
      maxTokens: 8000
      costPerRequest: 0.003
    
    tier3:
      provider: "openai"
      model: "gpt-4o-mini"
      temperature: 0.7
      maxTokens: 8000
      costPerRequest: 0.005
  
  # Fallback chain: tier1 -> tier2 -> tier3
  fallbackChain: ["tier1", "tier2", "tier3"]
  
  # Budget limits
  budget:
    dailyLimit: 10  # USD
    monthlyLimit: 50  # USD

# Agent Definitions
agents:
  news-aggregator:
    enabled: true
    schedule: "0 6 * * *"  # Daily at 6 AM UTC
    outputPath: "news"
    category: "news"
    
    config:
      maxArticlesPerRun: 1
      deduplicationWindow: "7d"
      minRelevanceScore: 0.7
      
      sources:
        rss:
          - url: "https://hackaday.com/feed/"
            name: "Hackaday"
            weight: 1.0
            categories: ["embedded", "hardware", "diy"]
          
          - url: "https://www.embedded.com/feed/"
            name: "Embedded.com"
            weight: 1.2
            categories: ["embedded", "professional"]
          
          - url: "https://www.cnx-software.com/feed/"
            name: "CNX Software"
            weight: 1.0
            categories: ["embedded-linux", "sbc"]
          
          - url: "https://interrupt.memfault.com/feed.xml"
            name: "Interrupt (Memfault)"
            weight: 1.3
            categories: ["embedded", "debugging", "technical"]
          
          - url: "https://www.eetimes.com/feed/"
            name: "EE Times"
            weight: 1.1
            categories: ["industry", "hardware"]
          
          - url: "https://www.zephyrproject.org/feed/"
            name: "Zephyr Project"
            weight: 1.0
            categories: ["rtos", "embedded"]
        
        apis:
          hackernews:
            enabled: true
            keywords: ["embedded", "RTOS", "microcontroller", "STM32", "ESP32", "ARM Cortex"]
            minScore: 50
            maxResults: 10
      
      prompts:
        systemPrompt: |
          You are an expert embedded systems engineer and technical writer.
          Your job is to ANALYZE and INTERPRET news, not copy it.
          Write original content that provides insights, implications, and practical takeaways.
          IMPORTANT: Respond ONLY with valid JSON. No markdown code blocks, no explanations outside JSON.
          The JSON must have: title, description, content (full markdown article), tags array, and category.
        
        userPromptTemplate: |
          Read this article and write an ORIGINAL analysis for embedded systems developers:
          
          **Source Article:** {title}
          **From:** {source}
          **URL:** {url}
          **Original Content:** {content}
          
          Respond with ONLY valid JSON (no ```json blocks):
          {
            "title": "Your own analytical title (not the source title)",
            "description": "What this means for embedded developers (150-160 chars)",
            "content": "Write 800-1200 words of ORIGINAL ANALYSIS following this structure:\n\n## Overview\n\nBriefly explain what happened and why it matters to embedded developers.\n\n## Technical Implications\n\n### For Hardware Developers\n- **Key point**: Your analysis\n- **Key point**: Your analysis\n\n### For Firmware Engineers\n- **Key point**: Your analysis\n- **Key point**: Your analysis\n\n## Real-World Applications\n\nHow can embedded developers use this? Provide 2-3 concrete examples.\n\n## Key Takeaways\n\n- **Lesson 1**: What developers should learn from this\n- **Lesson 2**: Actionable insight\n- **Lesson 3**: Future consideration\n\n## Conclusion\n\nSummarize the main impact and next steps.\n\nIMPORTANT: Do NOT copy text from the source. Provide YOUR analysis, interpretation, and insights. Focus on practical implications for embedded systems development.",
            "tags": ["tag1", "tag2", "tag3", "tag4", "tag5"],
            "category": "news"
          }
          
          Write original content analyzing the source, not summarizing it!
    
    # Agent-specific AI model override
    aiModel: "tier1"  # Use free Gemini for news

  diy-tutorials:
    enabled: true
    schedule: "0 8 * * 1"  # Mondays at 8 AM UTC
    outputPath: "tutorials"
    category: "tutorials"
    
    config:
      topicsPerRun: 2
      minSourcesPerTopic: 5
      difficultyLevels: ["beginner", "intermediate", "advanced"]
      
      sources:
        reddit:
          subreddits:
            - name: "embedded"
              weight: 1.3
              minUpvotes: 100
            
            - name: "AskElectronics"
              weight: 1.2
              minUpvotes: 80
            
            - name: "arduino"
              weight: 1.0
              minUpvotes: 100
            
            - name: "esp32"
              weight: 1.1
              minUpvotes: 80
          
          sortBy: "top"
          timeFrame: "month"
        
        stackexchange:
          sites:
            - name: "electronics"
              tags: ["microcontroller", "embedded", "firmware"]
              minScore: 50
            
            - name: "arduino"
              tags: ["programming", "sensors", "communication"]
              minScore: 30
        
        forums:
          - url: "https://esp32.com"
            type: "discourse"
            enabled: true
            rateLimit: 30  # requests per minute
      
      prompts:
        topicDiscovery: |
          Analyze these forum discussions and identify trending DIY embedded systems project ideas.
          Look for:
          - Frequently asked questions
          - Popular project types
          - Common problem areas
          - Emerging technologies
          
          Return a ranked list of tutorial topics that would benefit the community.
        
        tutorialOutline: |
          Create a comprehensive tutorial outline for: {topic}
          
          Target audience: {difficulty}
          
          Structure:
          1. Introduction (why this matters, prerequisites)
          2. Components/Tools needed
          3. Step-by-step implementation
          4. Code examples with explanations
          5. Testing and debugging
          6. Common pitfalls and solutions
          7. Next steps and extensions
          
          Make it practical, beginner-friendly, and include real code examples.
        
        tutorialWriter: |
          Write a detailed tutorial section: {section}
          
          Context: {outline}
          
          Guidelines:
          - Use clear, simple language
          - Include code snippets with inline comments
          - Add diagrams/circuit descriptions where helpful
          - Explain the "why" not just the "how"
          - Include debugging tips
          - Format in markdown
    
    # Use better model for complex tutorial generation
    aiModel: "tier2"  # Use Groq Llama 3.3 70B (cheap, good quality)

  bhagavad-gita:
    enabled: true
    schedule: "0 7 * * *"  # Daily at 7 AM UTC
    outputPath: "bhagavad-gita"
    category: "bhagavad-gita"
    
    config:
      # One shloka per run - will take 700 runs to complete the entire Gita
      # Progress is tracked in .progress.json file
      
      prompts:
        systemPrompt: |
          You are a Sanskrit scholar and spiritual teacher with deep knowledge of the Bhagavad Gita.
          Your job is to provide accurate translations and meaningful explanations of each shloka (verse).
          
          IMPORTANT: Respond ONLY with valid JSON. No markdown code blocks, no explanations outside JSON.
          The JSON must include: title, description, sanskrit (devanagari), transliteration (IAST), 
          translation (English), content (detailed explanation in markdown), and tags array.
          
          Your explanations should:
          - Be accessible to modern readers
          - Provide historical and philosophical context
          - Explain practical applications of the teachings
          - Connect ancient wisdom to contemporary life
        
        userPromptTemplate: |
          Generate a comprehensive blog post for Bhagavad Gita Chapter {chapter}, Verse {verse}.
          
          Chapter name: {chapterName}
          
          Respond with ONLY valid JSON (no ```json blocks):
          {
            "title": "Meaningful title for Chapter {chapter}, Verse {verse}",
            "description": "One-sentence summary of the verse's core teaching (150-160 chars)",
            "sanskrit": "The complete shloka in Devanagari script",
            "transliteration": "IAST romanized transliteration of the Sanskrit",
            "translation": "Accurate English translation of the verse",
            "content": "Write a detailed 600-900 word explanation in markdown following this structure:\n\n## The Shloka\n\n**Sanskrit (Devanagari):**\n{sanskrit}\n\n**Transliteration (IAST):**\n{transliteration}\n\n**Translation:**\n{translation}\n\n## Explanation\n\n### Context\nProvide the context of this verse within the chapter and the overall Gita narrative.\n\n### Word-by-Word Meaning\nBreak down key Sanskrit terms and their significance.\n\n### Deeper Understanding\nExplain the philosophical and spiritual teachings of this verse:\n- What is Krishna teaching Arjuna?\n- What are the key concepts presented?\n- How does this relate to dharma, karma, yoga, or other Gita themes?\n\n### Practical Application\nHow can a modern reader apply this teaching in daily life? Provide 2-3 concrete examples.\n\n### Reflection\nQuestions or points for contemplation.\n\n## Key Concepts\n\nHighlight 3-4 key spiritual or philosophical concepts from this verse.",
            "tags": ["Bhagavad Gita", "{chapterName}", "tag3", "tag4", "tag5"],
            "category": "bhagavad-gita"
          }
          
          Ensure accuracy in Sanskrit, transliteration, and translation. Provide thoughtful, authentic explanations.
    
    # Use tier1 (Gemini) for Gita generation - good at languages and cultural content
    aiModel: "tier1"

# Reference to encrypted secrets file
secretsFile: "./config/secrets.enc.yaml"
