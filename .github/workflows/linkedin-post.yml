name: Post to LinkedIn via Zapier

on:
  workflow_dispatch:
    inputs:
      post_text:
        description: 'Text to post on LinkedIn'
        required: true
        default: |
          ðŸ”— I Built an Automated LinkedIn Posting System â€” Here's How!

          Hi LinkedIn! ðŸ‘‹

          This post was autonomously generated and published by an AI agent â€” no human clicked "Post"!

          I'm Deepak Singhal, and as part of my #100WebsitesIn100Days Challenge, I created a fully automated LinkedIn posting pipeline using:

          ðŸ› ï¸ Tech Stack:
          â€¢ GitHub Actions - Workflow automation
          â€¢ Zapier Webhooks - LinkedIn API integration
          â€¢ JSON payload handling with jq
          â€¢ Zero manual intervention required

          âš¡ How it works:
          1ï¸âƒ£ Trigger workflow from GitHub Actions tab
          2ï¸âƒ£ GitHub sends POST request to Zapier webhook
          3ï¸âƒ£ Zapier receives the payload and posts to LinkedIn
          4ï¸âƒ£ Post appears on my profile â€” automatically!

          ðŸ’¡ Why this matters:
          â€¢ Build in public with automated updates
          â€¢ Schedule content without third-party tools
          â€¢ Full control over posting logic
          â€¢ Free tier friendly (GitHub Actions + Zapier)

          ðŸŒ Check out my blog: blog.sarcasticrobo.online
          ðŸ“‚ Source code: github.com/deepak4395/personalBlog

          ðŸ¤– This post was crafted & published by my AI agent: SarcasticRobo

          Want me to share the step-by-step tutorial? Drop a comment! ðŸ‘‡

          ---
          #AI #Automation #GitHubActions #Zapier #NoCode #AIAgent #BuildInPublic #100DaysChallenge #IndieHacker #WebDevelopment #SarcasticRobo #DevOps #LinkedInAutomation

jobs:
  post-to-linkedin:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    steps:
      - name: Post to LinkedIn via Zapier
        env:
          POST_TEXT: ${{ github.event.inputs.post_text }}
          WEBHOOK_URL: ${{ secrets.ZAPIER_WEBHOOK_URL }}
        run: |
          # Create JSON payload file with proper escaping
          jq -n --arg text "$POST_TEXT" '{"text": $text}' > payload.json
          
          # Send the request
          curl -f --max-time 30 -X POST "$WEBHOOK_URL" \
            -H "Content-Type: application/json" \
            -d @payload.json
          
          # Cleanup
          rm payload.json
          
      - name: Confirm post
        run: echo "âœ… LinkedIn post sent successfully via Zapier!"